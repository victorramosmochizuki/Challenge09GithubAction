<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">
    <h:head>
        <title>Facelet Title</title>
        <f:event listener="#{ClienteC.listar()}" type="preRenderView" />

    </h:head>
    <h:body >
        <p:growl id="mensaje" severity="info, fatal" showDetail="true" showSummary="true" />
        <p:growl id="growl-sticky" for="sticky-key" showDetail="true" showSummary="true" />
        <p:menubar>
            <p:submenu label="tablas maestras">
                <p:menuitem value="cliente" outcome="Cliente"/>
                <p:menuitem value="repuesto" outcome="Repuestos"/>
                <p:menuitem value="Empleado" outcome="Empleado"/>
                <p:menuitem value="Motos" outcome="Motos"/>
                <p:menuitem value="Venta" outcome="Venta"/>
                <p:menuitem value="Compra" outcome="Compra"/>
                <p:menuitem value="Proveedor" outcome="Proveedor"/>
            </p:submenu> 
        </p:menubar>

        <center>
            <h1> Registro de cliente</h1>
        </center>


        <center>
            <h:form id="power"> 
                <p:panelGrid >
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Nombre" />
                        </p:column>
                        <p:column>
                            <p:inputText value="#{ClienteC.cli.nomclie}"  id="nombre" 
                                         required="true" requiredMessage="falta nombre"  style="width: 315px">
                                <p:keyFilter regEx="/[A-z_ñ_á_é_í_ó_ú_Á_É_Í_Ó_Ú_' ']/" />
                                <p:tooltip for="nombre" value="Ingrese sus nombres" trackMouse="focus"/>
                            </p:inputText>
                            <p:message id="msgNombres" for="nombre" display="text" />
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>

                            <p:outputLabel value="Apellido" />
                        </p:column>
                        <p:column>
                            <p:inputText value="#{ClienteC.cli.apeclie}" id="apellido"  maxlength="30" 
                                         required="true" requiredMessage="apellido"  style="width: 315px">
                                <p:keyFilter regEx="/[A-z_ñ_á_é_í_ó_ú_Á_É_Í_Ó_Ú_' ']/" />
                                <p:tooltip for="apellido" value="Ingrese sus apellido" trackMouse="focus"/>

                            </p:inputText>
                            <p:message id="msgApellidos" for="apellido" display="text" /> 
                        </p:column>
                    </p:row>

                    <p:row>
                        <p:column>
                            <p:outputLabel value="Celular" />
                        </p:column>
                        <p:column>
                            <p:inputText value="#{ClienteC.cli.celclie}" maxlength="9" id="celular" style="width: 315px">
                                <f:validator validatorId="validarCelular"/>
                                <p:ajax update="msgCelular" event="keyup"/>
                                <p:tooltip for="celular" value="Digíte el numero de celular" trackMouse="focus"/>
                                <p:keyFilter regEx="/[0-9]/" />
                            </p:inputText>
                            <p:message for="celular" id="msgCelular" display="text"/>
                        </p:column>

                    </p:row>
                    <p:row>


                        <p:column>
                            <p:outputLabel value="Documento de I" />
                        </p:column>
                        <p:column>
                            <p:inputText value="#{ClienteC.cli.docclie}" maxlength="8" id="DNI" style="width: 315px" >
                                <f:validator validatorId="validarDni" />
                                <p:ajax update="msgDni" event="keyup"/>
                                <p:tooltip for="DNI" value="Ingrese el DNI" trackMouse="focus" />
                                <p:keyFilter regEx="/[0-9]/" />
                            </p:inputText>
                            <p:message for="DNI" id="msgDni" display="text"/>
                        </p:column>
                    </p:row>

                    <p:row>
                        <p:column>
                            <p:outputLabel value="Email" />
                        </p:column>
                        <p:column>
                            <p:inputText value="#{ClienteC.cli.emaclie}"  id="email" style="width: 315px">
                                <f:validator validatorId="validarEmail"/>
                                <p:ajax update="msgEmail" event="keyup"/>
                                <p:tooltip for="email" value="Ingrese el correo" trackMouse="focus"/>
                            </p:inputText>
                            <p:message for="email" id="msgEmail" display="text"/>
                        </p:column>
                    </p:row>
                </p:panelGrid>
            </h:form>
            <p:commandButton value="Registrar" actionListener="#{ClienteC.registrar()}" update=":MostrarCliente:tablacli mensaje "/>
            <p:commandButton value="Limpiar" actionListener="#{ClienteC.limpiar()}" update=":power"/>
            <h:form >
                <center>
                    <h:commandLink>
                        <h:graphicImage url="/logo/pdf.png" width="50px"/>
                        <p:dataExporter type="pdf" target=":MostrarCliente:tablacli" fileName="Listado de proveedor" />
                    </h:commandLink> 


                    <h:commandLink>
                        <h:graphicImage url="/logo/exel.png" width="50px"/>
                        <p:dataExporter type="xls" target=":MostrarCliente:tablacli" fileName="Listado de proveedor" />
                    </h:commandLink>
                    <p:commandButton value="Exportar Clientes" icon="fa fa-fx fa-dowload" styleClass="" ajax="false"
                                     style="float:right; background-color: yellowgreen" actionListener="#{ClienteC.reportePersona()}"
                                     onclick="this.form.target = '_blank'" title="Relacion de Clientes"
                                     />

                </center>
            </h:form>
            <h:form id="MostrarCliente">
                <p:dataTable var="tblcli" id="tablacli" value="#{ClienteC.listadoCli}" rows="5" 
                             paginator="true"
                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                             rowsPerPageTemplate="1,5,{ShowAll|'All'}" >
                    <p:column  sortBy="#{tblcli.docclie}" filterBy="#{tblcli.idcli}" headerText="ID"  >
                        <h:outputText value="#{tblcli.idcli}"  />
                    </p:column>  
                    <p:column headerText="Documento de I." >
                        <h:outputText value="#{tblcli.docclie}"  />
                    </p:column>    
                    <p:column headerText="Nombre" >
                        <h:outputText value="#{tblcli.nomclie}"  />
                    </p:column>  
                    <p:column headerText="Apellido" >
                        <h:outputText value="#{tblcli.apeclie}"  />
                    </p:column>  
                    <p:column headerText="Celular" >
                        <h:outputText value="#{tblcli.celclie}"  />
                    </p:column>  

                    <p:column headerText="Email" >
                        <h:outputText value="#{tblcli.emaclie}"  />
                    </p:column>  

                    <p:column headerText="Modificar">
                        <p:commandButton icon="ui-icon-pencil" oncomplete="PF('wdlgDatos').show();" update=":formModificar" >
                            <f:setPropertyActionListener value="#{tblcli}" target="#{ClienteC.cli}" />
                        </p:commandButton>

                    </p:column> 
                    <p:column style="width: 100px" headerText="Eliminar">
                        <p:commandButton icon="ui-icon-trash" actionListener="#{ClienteC.eliminar(tblcli)}" update="tablacli"  >
                            <p:confirm header="Confirmación" message="¿Desea Eliminar?" icon="ui-icon-alert"/>
                            <p:tooltip trackMouse="true"/>
                        </p:commandButton>
                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                            <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
                            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>
                        </p:confirmDialog>
                    </p:column>
                </p:dataTable>
            </h:form>

            <p:dialog header="Datos del Cliente" widgetVar="wdlgDatos" id="dlgDatos">
                <h:form id="formModificar">
                    <p:panelGrid >
                        <p:row>
                            <p:column>
                                <p:outputLabel value="Nombre" />
                            </p:column>
                            <p:column>
                                <p:inputText value="#{ClienteC.cli.nomclie}"  id="nombre" 
                                             required="true" requiredMessage="falta nombre">
                                    <p:keyFilter regEx="/[A-z_ñ_á_é_í_ó_ú_Á_É_Í_Ó_Ú_' ']/" />
                                    <p:tooltip for="nombre" value="Ingrese sus nombres" trackMouse="focus"/>
                                </p:inputText>
                                <p:message id="msgNombres" for="nombre" display="text" />
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column>

                                <p:outputLabel value="Apellido" />
                            </p:column>
                            <p:column>
                                <p:inputText value="#{ClienteC.cli.apeclie}" id="apellido"  maxlength="30" 
                                             required="true" requiredMessage="apellido">
                                    <p:keyFilter regEx="/[A-z_ñ_á_é_í_ó_ú_Á_É_Í_Ó_Ú_' ']/" />
                                    <p:tooltip for="apellido" value="Ingrese sus apellido" trackMouse="focus"/>

                                </p:inputText>
                                <p:message id="msgApellidos" for="apellido" display="text" /> 
                            </p:column>

                        </p:row>

                        <p:row>
                            <p:column>
                                <p:outputLabel value="Celular" />
                            </p:column>
                            <p:column>
                                <p:inputText value="#{ClienteC.cli.celclie}"
                                             required="true" requiredMessage="falta celular"
                                             maxlength="9" id="celular">               
                                    <p:keyFilter regEx="/[0-9]/"/>            
                                    <p:tooltip for="celular" value="Ingresar # Teléfonico" trackMouse="focus"/>    

                                </p:inputText>
                                <p:message id="msCelular" for="celular"/>
                            </p:column>

                        </p:row>
                        <p:row>


                            <p:column>
                                <p:outputLabel value="Documento de I" />
                            </p:column>
                            <p:column>
                                <p:inputText value="#{ClienteC.cli.docclie}" 
                                             required="true" requiredMessage="Falta DNI"
                                             maxlength="8" id="DNI">
                                    <p:keyFilter regEx="/[0-8]/"/>                 
                                    <p:tooltip for="DNI" value="colocar tu DNI" trackMouse="focus"/>     
                                </p:inputText>
                            </p:column>
                        </p:row>

                        <p:row>
                            <p:column>
                                <p:outputLabel value="Email" />
                            </p:column>
                            <p:column>
                                <p:inputText value="#{ClienteC.cli.emaclie}" id="email" 
                                             required="true" requiredMessage="se requiere gmail"/>
                            </p:column>
                        </p:row>

                        <p:commandButton value="Cancelar" immediate="true" oncomplete="PF('wdlgDatos').hide();" actionListener="#{ClienteC.limpiar()}" />
                        <p:commandButton id="modicardialog" value="Modificar" actionListener="#{ClienteC.modificar()}" 
                                         update="formModificar :MostrarCliente:tablacli" 
                                         oncomplete="if(!args.validationFailed)PF('wdlgDatos').hide();"/>
                    </p:panelGrid>
                </h:form>
            </p:dialog>
        </center>
    </h:body>
</html>
